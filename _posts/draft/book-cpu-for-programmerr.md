---
title: 読書メモ_プログラマーのためのCPU入門
description: 読書メモ
date: '2024-05-30'
tag:
  - 読書メモ
---

## 読んだ本
https://www.lambdanote.com/products/cpu


## メモ
現代的なCPUとは
タスク（処理）を並列実行していく
スーパースカラ化

スーパーパイプライン化

そもそものCPUでもタスク（処理）には命令フェッチ・命令デコード・命令実行に分割されている。

SRAMがたくさんの容量にできない理由がいまいちわからん

### エウレーカ
- 除算はその他四則演算に比べレイテンシが数倍〜数十倍になる。
- データの依存関係で処理の待ちが生まれる（並び替えが利かない）ことでレイテンシが生まれる。

- 様々な最適化がすでにCPUには盛り込まれている。以下はその一部
  - 分岐履歴テーブル等による分岐予測
  - 仮想メモリ（ミスによる負の影響がでかい）
  - テーブルウォークへの解決案のTLB（Translation Lookaside Buffer）
  - でかいプログラムは環境によってどこのサイズからか急に遅くなる感覚はCPUレベルから起こる
  - ページフォルトによるダメージはでかい（主記憶になく、二次記憶デバイスまで参照する）
  - I/OライトもしくはI/OリードでI/Oデバイスを操作する
  - DMAは、CPUを介さずにメモリ間（ex.キーボードとDRAM）でデータを転送するための仕組み


- 仮想メモリには自分のソフトウェアのみがメモリを専有してるかのように見せることで使い勝手を高められる（言われたら想像できたが、言われないと気づけなかった）
- 


- 現在主流の共有メモリ型マルチプロセッサは、CPU間でのデータ送受信をメモリアクセス
操作によって実現できることから使い勝手が良い
- メッセージ交換型が存在はしている裏で共有メモリ型でデータのやりとりをするのは隠れたコストを払っている
- キャッシュコヒーレンス制御
  - 複数のキャッシュ付きCPUに同じDRAMのアドレスと値をコピーした後にとあるCPUがそのアドレスの値を（キャッシュ）で書き換えた状況等の制御
    - マルチプロセッサにおける各CPU上でのソフトウェアは、互いに非同期に実行されているため、「同一のアドレスに対して瞬間的に異なる値を読むこと」自体が直ちに問題となるわけではないことに注意してください。ここで紹介した状況が本当に問題となるのは、値がいつまでも他のCPUに伝わらないことや、伝わり方がCPUによって異なることです。したがって、この課題を「キャッシュ間における値の不一致」として捉えるのは早計だと言えます。

### ハンズオン
分岐命令がどれだけの頻度で現れるか
`objdump -Mintel -d -j.text /bin/ls | less`

割り込みの履歴
`cat /proc/interrupts`


### 疑問
- TLBのエントリを書き換える操作や、無効化する操作が、スーパーバイザ権限で提
供されている場合があります。
  - このスーパバイザ権限ってどこ視点？


### 参考文献
- [Automatically unlock gnome keyring at boot - Desktop Environments / All WMs - EndeavourOS](https://forum.endeavouros.com/t/automatically-unlock-gnome-keyring-at-boot/24216)
- [Troubleshooting keychain issues - Settings Sync in Visual Studio Code](https://code.visualstudio.com/docs/editor/settings-sync#_troubleshooting-keychain-issues)
