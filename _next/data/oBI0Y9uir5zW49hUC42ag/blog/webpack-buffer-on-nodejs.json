{"pageProps":{"frontmatter":{"title":"WebpackでBuffer（Node.js）を使う","date":"2022-01-02","tag":["webpack","Node.js"]},"slug":"webpack-buffer-on-nodejs","innerHtml":"<p>駆け出しエンジニアのふわっとした理解を書く。\nNode.jsのコアモジュールであるBuffer()をフロント側で使いたいときがあるらしい。<a href=\"https://github.com/CyberAgentHack/web-speed-hackathon-2021/blob/135468cc9f69f6f27ba0bc9d3b74d60f1ebe3a40/client/src/components/foundation/CoveredImage/CoveredImage.jsx#L21-L23\">参考の該当箇所</a>（パフォーマンスチューニングを行う元して書かれたソースコードなので、ベストプラクティス的ではないのかもしれないが、初心者の私には判断つきません）</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> imageSize <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> data <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">?</span> <span class=\"token function\">sizeOf</span><span class=\"token punctuation\">(</span>Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3 id=\"%E8%A7%A3%E6%B1%BA%E7%AD%96\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#%E8%A7%A3%E6%B1%BA%E7%AD%96\" aria-hidden=\"true\">#</a> 解決策</h3>\n<p>解決策(といっても、元々のソースコードに書かれていたが)、下に記載する設定がないとブラウザから怒られてしまいます。</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">CoveredImage.jsx:22 Uncaught ReferenceError: Buffer is not defined\n</code></pre>\n<p><code>webpack.config.js</code> に以下のように追記する。</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>ProvidePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">Buffer</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'buffer'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Buffer'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n</code></pre>\n<h3 id=\"%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\" aria-hidden=\"true\">#</a> 参考文献</h3>\n<ul>\n<li><a href=\"https://github.com/diegomura/react-pdf/issues/1029\">https://github.com/diegomura/react-pdf/issues/1029</a></li>\n<li><a href=\"https://github.com/CyberAgentHack/web-speed-hackathon-2021\">https://github.com/CyberAgentHack/web-speed-hackathon-2021</a></li>\n<li><a href=\"https://webpack.js.org/plugins/provide-plugin/\">https://webpack.js.org/plugins/provide-plugin/</a></li>\n</ul>\n","createdAt":"2022-10-18","updatedAt":"2022-10-18"},"__N_SSG":true}