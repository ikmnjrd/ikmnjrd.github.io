{"pageProps":{"frontmatter":{"title":"pacmanミラーリストの更新","date":"2024-07-23","tag":["Linux","pacman"]},"slug":"pacman-mirrorlist","innerHtml":"<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">関連ソフトウェア</th>\n<th style=\"text-align:left\">バージョン</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">EndevaourOS</td>\n<td style=\"text-align:left\">Build=2024.01.25</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"%E7%B5%90%E8%AB%96\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#%E7%B5%90%E8%AB%96\" aria-hidden=\"true\">#</a> 結論</h2>\n<pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token string\">\"https://archlinux.org/mirrorlist/?country=JP&amp;country=AU&amp;protocol=https&amp;use_mirror_status=on\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">'s/^#Server/Server/'</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">'/^#/d'</span> <span class=\"token operator\">|</span> rankmirrors <span class=\"token parameter variable\">-n</span> <span class=\"token number\">5</span> - <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/pacman.d/mirrorlist\n</code></pre>\n<h2 id=\"%E7%B5%8C%E7%B7%AF%E3%81%A8%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%82%BF%E3%82%A4%E3%83%A0%E3%83%A9%E3%82%A4%E3%83%B3\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#%E7%B5%8C%E7%B7%AF%E3%81%A8%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%82%BF%E3%82%A4%E3%83%A0%E3%83%A9%E3%82%A4%E3%83%B3\" aria-hidden=\"true\">#</a> 経緯とシューティングタイムライン</h2>\n<p><code>$ sudo pacman -Syu</code>をするとエラー</p>\n<pre><code>エラー: ファイル 'core.db' を mirror.nishi.network から取得するのに失敗しました : Failed to connect to mirror.nishi.network port 443 after 7150 ms: Couldn't connect to server\nエラー: ファイル 'extra.db' を mirror.nishi.network から取得するのに失敗しました : Failed to connect to mirror.nishi.network port 443 after 7150 ms: Couldn't connect to server\nエラー: ファイル 'multilib.db' を mirror.nishi.network から取得するのに失敗しました : Failed to connect to mirror.nishi.network port 443 after 7150 ms: Couldn't connect to server\n警告: mirror.nishi.network からのエラーが多すぎるため、残りの処理ではスキップします\n</code></pre>\n<p><code>/etc/pacman.d/mirrorlist</code>はこうなってた</p>\n<pre><code>################################################################################\n################# Arch Linux mirrorlist generated by Reflector #################\n################################################################################\n\n# With:       reflector --verbose -c JP --protocol https --sort rate --latest 20 --download-timeout 5 --threads 5\n# When:       2024-04-02 14:59:21 UTC\n# From:       https://archlinux.org/mirrors/status/json/\n# Retrieved:  2024-04-02 14:57:27 UTC\n# Last Check: 2024-04-02 14:53:55 UTC\n\nServer = https://mirror.nishi.network/archlinux/$repo/os/$arch\nServer = https://mirrors.cat.net/archlinux/$repo/os/$arch\n</code></pre>\n<p><a href=\"https://wiki.archlinux.jp/index.php/%E3%83%9F%E3%83%A9%E3%83%BC\">ArchWiki</a>にも色々書いてあるが、とりあえずChatGPTにコマンド組んでもらったのが以下</p>\n<pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-s</span> <span class=\"token string\">\"https://archlinux.org/mirrorlist/?country=JP&amp;country=AU&amp;protocol=https&amp;use_mirror_status=on\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">'s/^#Server/Server/'</span> <span class=\"token parameter variable\">-e</span> <span class=\"token string\">'/^#/d'</span> <span class=\"token operator\">|</span> rankmirrors <span class=\"token parameter variable\">-n</span> <span class=\"token number\">5</span> - <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> /etc/pacman.d/mirrorlist\n</code></pre>\n<p>実行後に生成したファイルの中身は以下</p>\n<pre><code>Server = https://repo.jing.rocks/archlinux/$repo/os/$arch\nServer = https://jp.mirrors.cicku.me/archlinux/$repo/os/$arch\nServer = https://mirrors.cat.net/archlinux/$repo/os/$arch\nServer = https://ftp.jaist.ac.jp/pub/Linux/ArchLinux/$repo/os/$arch\nServer = https://www.miraa.jp/archlinux/$repo/os/$arch\n</code></pre>\n<h3 id=\"%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE\" aria-hidden=\"true\">#</a> 参考文献</h3>\n<ul>\n<li><a href=\"https://wiki.archlinux.jp/index.php/%E3%83%9F%E3%83%A9%E3%83%BC\">ミラー - ArchWiki</a></li>\n<li></li>\n</ul>\n"},"__N_SSG":true}